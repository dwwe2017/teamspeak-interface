(function(d){d.fn.serverBanCreate=function(c,e){var a=d.extend({a:"",id:"",sid:"",cldbid:this.attr("data-cldbid"),block:""},c),f=parseInt(prompt("TIME FOR BANN IN MINUTES (0 = FOREVER)","60"),10),g=prompt("REASON MESSAGE (optional)",""),b=a.block,k=this;if(a.id&&0!==a.id.length)if(a.sid&&0!==a.sid.length)if(a.cldbid&&0!==a.cldbid.length)if(f)if(g){(c="index.php?controller=ajax&action=banCreate",""!==c)||(c=document.location.href.match(/^([^#]+)/)[1]);a={a:a.a,id:a.id,sid:a.sid,cldbid:a.cldbid,minutes:f,
reasonmsg:g};var h=(new Date).getTime();d.ajax({url:c,dataType:"json",type:"POST",data:a,success:function(a,c,d){a.valid?(a=(new Date).getTime(),500>a-h?setTimeout(function(){b.removeBlockMessages({except:"table-message"}).blockMessage(tjs.get("Ban created successfully"),{type:"success",position:"top"})},500-(a-h)):b.removeBlockMessages({except:"table-message"}).blockMessage(tjs.get("Ban created successfully"),{type:"success",position:"top"}),"function"===typeof e&&e.call(k)):a.error?b.removeBlockMessages({except:"table-message"}).blockMessage(a.error||
tjs.get("An unexpected error occurred, please try again"),{type:"error",position:"top"}):a.warning&&b.removeBlockMessages({except:"table-message"}).blockMessage(a.warning||tjs.get("An unexpected error occurred, please try again"),{type:"warning",position:"top"})},error:function(a,c,d){b.removeBlockMessages({except:"table-message"}).blockMessage(tjs.get("Error while contacting server, please try again"),{type:"error",position:"top"})}});b.removeBlockMessages({except:"table-message"}).blockMessage(tjs.get("Please wait, processing..."),
{type:"loading",position:"top"})}else b.removeBlockMessages({except:"table-message"}).blockMessage(tjs.get("Create ban aborted"),{type:"warning",position:"top"});else b.removeBlockMessages({except:"table-message"}).blockMessage(tjs.get("Create ban aborted"),{type:"warning",position:"top"});else b.removeBlockMessages({except:"table-message"}).blockMessage(tjs.get("Client database id is missing"),{type:"warning",position:"top"});else b.removeBlockMessages({except:"table-message"}).blockMessage(tjs.get("Virtual server id is missing"),
{type:"warning",position:"top"});else b.removeBlockMessages({except:"table-message"}).blockMessage(tjs.get("Entity id is missing"),{type:"warning",position:"top"})}})(jQuery);
