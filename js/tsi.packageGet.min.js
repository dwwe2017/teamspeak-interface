(function(a){a.fn.packageGet=function(d,f){var c=a.extend({a:"",noMargin:!0,reference:a(this).attr("data-dl-reference"),block:a(this).parents("section")},d),e=c.block;(d="index.php?controller=ajax&action=packageDl",""!==d)||(d=document.location.href.match(/^([^#]+)/)[1]);var h={a:c.a,reference:c.reference},g=(new Date).getTime();a.ajax({url:d,dataType:"json",type:"POST",data:h,success:function(b,a,d){b.valid&&b.response?(b=b.response,a=(new Date).getTime(),500>a-g?setTimeout(function(){e.removeBlockMessages({except:"no-hide"}).blockMessage(tjs.get("Package installed successfully"),
{type:"success",position:"top",noMargin:c.noMargin})},500-(a-g)):e.removeBlockMessages({except:"no-hide"}).blockMessage(tjs.get("Package installed successfully"),{type:"success",position:"top",noMargin:c.noMargin}),"function"===typeof f&&f.call(b)):b.error?e.removeBlockMessages({except:"no-hide"}).blockMessage(b.error||tjs.get("An unexpected error occurred, please try again"),{type:"error",position:"top",noMargin:c.noMargin}):b.warning&&e.removeBlockMessages({except:"no-hide"}).blockMessage(b.warning||
tjs.get("An unexpected error occurred, please try again"),{type:"warning",position:"top",noMargin:c.noMargin})},error:function(b,a,d){e.removeBlockMessages({except:"no-hide"}).blockMessage(tjs.get("Error while contacting server, please try again"),{type:"error",position:"top",noMargin:c.noMargin})}});e.removeBlockMessages({except:"no-hide"}).blockMessage(tjs.get("Please wait, downloading package..."),{type:"loading",position:"top",noMargin:c.noMargin})}})(jQuery);
