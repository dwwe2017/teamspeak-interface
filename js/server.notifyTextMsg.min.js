(function(b){b.fn.serverNotifyTextMsg=function(e,f){var a=b.extend({a:"",id:"",sid:"",handler:b("#ajax-chat-auto-refresh"),block:this},e),d=b(a.block);if(a.id&&0!==a.id.length)if(a.sid&&0!==a.sid.length){(e="index.php?controller=ajax&action=serverNotifyTextMsg",""!==e)||(e=document.location.href.match(/^([^#]+)/)[1]);var h={a:a.a,id:a.id,sid:a.sid},g=(new Date).getTime();b.ajax({url:e,dataType:"json",type:"POST",data:h,success:function(c,b,e){c.valid&&c.response?(c=c.response,b=(new Date).getTime(),
500>b-g?setTimeout(function(){d.removeBlockMessages().blockMessage(tjs.get("Message received"),{type:"success",position:"top"})},500-(b-g)):d.removeBlockMessages().blockMessage(tjs.get("Message received"),{type:"success",position:"top"}),"function"===typeof f&&f.call(c)):c.error?(d.removeBlockMessages().blockMessage(c.error||tjs.get("An unexpected error occurred, please try again"),{type:"error",position:"top"}),a.handler.prop("checked",!1).prop("disabled",!0)):c.warning&&(d.removeBlockMessages().blockMessage(c.warning||
tjs.get("An unexpected error occurred, please try again"),{type:"warning",position:"top"}),a.handler.prop("checked",!1).prop("disabled",!0))},error:function(c,b,e){d.removeBlockMessages().blockMessage(tjs.get("Error while contacting server, please try again"),{type:"error",position:"top"});a.handler.prop("checked",!1).prop("disabled",!0)}});d.removeBlockMessages().blockMessage(tjs.get("Chat Bot is listening..."),{type:"loading",position:"top"});a.handler.prop("checked",!0).prop("disabled",!1)}else d.removeBlockMessages().blockMessage(tjs.get("Virtual server id is missing"),
{type:"warning",position:"top"}),a.handler.prop("checked",!1).prop("disabled",!0);else d.removeBlockMessages().blockMessage(tjs.get("Entity id is missing"),{type:"warning",position:"top"}),a.handler.prop("checked",!1).prop("disabled",!0)}})(jQuery);
