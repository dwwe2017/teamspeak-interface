(function(d){d.fn.serverSnapshotImport=function(a,f){a=d.extend({a:"",id:"",sid:"",en_type:d("#en_type").val()},a);var b=this;if(a.id&&0!==a.id.length)if(a.sid&&0!==a.sid.length)if(a.en_type&&0!==a.en_type.length){var e="index.php?controller=ajax&action=snapshotImport";e&&""!==e||(e=document.location.href.match(/^([^#]+)/)[1]);var c=new FormData(b[0]);c.append("a",a.a);c.append("id",a.id);c.append("sid",a.sid);c.append("en_type",a.en_type);var g=(new Date).getTime();d.ajax({url:e,dataType:"json",
type:"POST",data:c,processData:!1,contentType:!1,success:function(a,c,d){a.valid?(a=(new Date).getTime(),500>a-g?setTimeout(function(){b.removeBlockMessages({except:"no-hide"}).blockMessage(tjs.get("Snapshot(s) successfully imported"),{type:"success",position:"top"})},500-(a-g)):b.removeBlockMessages({except:"no-hide"}).blockMessage(tjs.get("Snapshot(s) successfully imported"),{type:"success",position:"top"}),"function"===typeof f&&f.call(b)):a.error?b.removeBlockMessages({except:"no-hide"}).blockMessage(a.error||
tjs.get("An unexpected error occurred, please try again"),{type:"error",position:"top"}):a.warning&&b.removeBlockMessages({except:"no-hide"}).blockMessage(a.warning||tjs.get("An unexpected error occurred, please try again"),{type:"warning",position:"top"})},error:function(a,c,d){b.removeBlockMessages({except:"no-hide"}).blockMessage(tjs.get("Error while contacting server, please try again"),{type:"error",position:"top"})}});b.removeBlockMessages({except:"no-hide"}).blockMessage(tjs.get("Please wait, import is running..."),
{type:"loading",position:"top"})}else b.removeBlockMessages({except:"no-hide"}).blockMessage(tjs.get("Enryption type is missing"),{type:"warning",position:"top"});else b.removeBlockMessages({except:"no-hide"}).blockMessage(tjs.get("Virtual server id is missing"),{type:"warning",position:"top"});else b.removeBlockMessages({except:"no-hide"}).blockMessage(tjs.get("Entity id is missing"),{type:"warning",position:"top"})}})(jQuery);
