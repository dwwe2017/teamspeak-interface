(function(d){d.fn.channelMsgSend=function(b,e){var a=d.extend({a:"",id:"",sid:"",cid:"",message:"",block:this},b),c=d(a.block);if(a.id&&0!==a.id.length)if(a.sid&&0!==a.sid.length)if(a.cid&&0!==a.cid.length)if(a.message&&0!==a.message.length){(b="index.php?controller=ajax&action=channelMsgSend",""!==b)||(b=document.location.href.match(/^([^#]+)/)[1]);a={a:a.a,id:a.id,sid:a.sid,cid:a.cid,message:a.message};var f=(new Date).getTime();d.ajax({url:b,dataType:"json",type:"POST",data:a,success:function(a,
b,d){a.valid?(a=a.response,b=(new Date).getTime(),500>b-f?setTimeout(function(){c.removeBlockMessages().blockMessage(tjs.get("Message send successfully"),{type:"success",position:"top"})},500-(b-f)):c.removeBlockMessages().blockMessage(tjs.get("Message send successfully"),{type:"success",position:"top"}),"function"===typeof e&&e.call(a)):a.error?c.removeBlockMessages().blockMessage(a.error||tjs.get("An unexpected error occurred, please try again"),{type:"error",position:"top"}):a.warning&&c.removeBlockMessages().blockMessage(a.warning||
tjs.get("An unexpected error occurred, please try again"),{type:"warning",position:"top"})},error:function(a,b,d){c.removeBlockMessages().blockMessage(tjs.get("Error while contacting server, please try again"),{type:"error",position:"top"})}});c.removeBlockMessages().blockMessage(tjs.get("Please wait, sending message..."),{type:"loading",position:"top"})}else c.removeBlockMessages().blockMessage(tjs.get("Message is missing"),{type:"warning",position:"top",style:"margin-bottom: 0"});else c.removeBlockMessages().blockMessage(tjs.get("Channel id is missing"),
{type:"warning",position:"top"});else c.removeBlockMessages().blockMessage(tjs.get("Virtual server id is missing"),{type:"warning",position:"top"});else c.removeBlockMessages().blockMessage(tjs.get("Entity id is missing"),{type:"warning",position:"top"})}})(jQuery);
