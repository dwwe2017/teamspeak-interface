(function(f){f.fn.serverTplCopy=function(c,e){var a=f.extend({a:"",id:this.attr("data-id"),filename:this.attr("data-filename"),block:""},c),d=a.block,g=this;if(a.filename&&0!==a.filename.length){(c="index.php?controller=ajax&action=serverTplCopy",""!==c)||(c=document.location.href.match(/^([^#]+)/)[1]);a={a:a.a,id:a.id,filename:a.filename};var h=(new Date).getTime();f.ajax({url:c,dataType:"json",type:"POST",data:a,success:function(b,a,c){b.valid?(b=(new Date).getTime(),500>b-h?setTimeout(function(){d.removeBlockMessages({except:"table-message"}).blockMessage(tjs.get("Copy created successfully"),
{type:"success",position:"top"});"function"===typeof e&&e.call(g)},500-(b-h)):(d.removeBlockMessages({except:"table-message"}).blockMessage(tjs.get("Copy created successfully"),{type:"success",position:"top"}),"function"===typeof e&&e.call(g))):b.error?d.removeBlockMessages({except:"table-message"}).blockMessage(b.error||tjs.get("An unexpected error occurred, please try again"),{type:"error",position:"top"}):b.warning&&d.removeBlockMessages({except:"table-message"}).blockMessage(b.warning||tjs.get("An unexpected error occurred, please try again"),
{type:"warning",position:"top"})},error:function(a,c,e){d.removeBlockMessages({except:"table-message"}).blockMessage(tjs.get("Error while contacting server, please try again"),{type:"error",position:"top"})}});d.removeBlockMessages({except:"table-message"}).blockMessage(tjs.get("Please wait, processing..."),{type:"loading",position:"top"})}else d.removeBlockMessages({except:"table-message"}).blockMessage(tjs.get("Template name is missing"),{type:"warning",position:"top"})}})(jQuery);
