(function(d){d.fn.iconTransfer=function(b,f){var a=d.extend({a:"",id:"",sid:"",icons:d("#sys_icons_transfer").val(),noMargin:!0},b),c=this;if(a.id&&0!==a.id.length)if(a.sid&&0!==a.sid.length)if(a.icons&&0!==a.icons.length){(b="index.php?controller=ajax&action=iconTransfer",""!==b)||(b=document.location.href.match(/^([^#]+)/)[1]);var h={a:a.a,id:a.id,sid:a.sid,icons:a.icons},g=(new Date).getTime();d.ajax({url:b,dataType:"json",type:"POST",data:h,success:function(e,b,d){e.valid?(b=(new Date).getTime(),
"function"===typeof f?f.call({data:e,form:c}):500>b-g?setTimeout(function(){c.removeBlockMessages({except:"no-hide"}).blockMessage(tjs.get("Icons successfully uploaded"),{type:"success",position:"top",noMargin:a.noMargin})},500-(b-g)):c.removeBlockMessages({except:"no-hide"}).blockMessage(tjs.get("Icons successfully uploaded"),{type:"success",position:"top",noMargin:a.noMargin})):e.error?c.removeBlockMessages({except:"no-hide"}).blockMessage(e.error||tjs.get("An unexpected error occurred, please try again"),
{type:"error",position:"top",noMargin:a.noMargin}):e.warning&&c.removeBlockMessages({except:"no-hide"}).blockMessage(e.warning||tjs.get("An unexpected error occurred, please try again"),{type:"warning",position:"top",noMargin:a.noMargin})},error:function(b,d,f){c.removeBlockMessages({except:"no-hide"}).blockMessage(tjs.get("Error while contacting server, please try again"),{type:"error",position:"top",noMargin:a.noMargin})}});c.removeBlockMessages({except:"no-hide"}).blockMessage(tjs.get("Please wait, sending data to server..."),
{type:"loading",position:"top",noMargin:a.noMargin})}else c.removeBlockMessages({except:"no-hide"}).blockMessage(tjs.get("No icons selected for transmission"),{type:"warning",position:"top",noMargin:a.noMargin});else c.removeBlockMessages({except:"no-hide"}).blockMessage(tjs.get("Virtual server id is missing"),{type:"warning",position:"top",noMargin:a.noMargin});else c.removeBlockMessages({except:"no-hide"}).blockMessage(tjs.get("Entity id is missing"),{type:"warning",position:"top",noMargin:a.noMargin})}})(jQuery);
