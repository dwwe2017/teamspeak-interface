var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,c,d){a instanceof String&&(a=String(a));for(var e=a.length,b=0;b<e;b++){var h=a[b];if(c.call(d,h,b,a))return{i:b,v:h}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,d){a!=Array.prototype&&a!=Object.prototype&&(a[c]=d.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,c,d,e){if(c){d=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var b=a[e];b in d||(d[b]={});d=d[b]}a=a[a.length-1];e=d[a];c=c(e);c!=e&&null!=c&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:c})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,d){return $jscomp.findInternal(this,a,d).v}},"es6","es3");
$(document).ready(function(){$("#instance_icon").change(function(){var a=$(this).find("option:selected").attr("data-prev");$("#instance_icon_preview").attr("src",a)});$("input[name=basis]").click(function(a){"ts3"===$(this).val()?($("#tls").parent().parent().hide(),$("#athp_link").parent().parent().show(),$("#query-port").attr("placeholder","10011")):($("#athp_link").parent().parent().hide(),$("#tls").parent().parent().show(),$("#query-port").attr("placeholder","10101"))});$("#server-form").submit(function(a){a.preventDefault();
a=btoa($("input[name=basis]:checked").val());var c=btoa($("#server-ip").val()),d=btoa($("#query-port").val()),e=btoa(encodeURIComponent($("#label").val())),b=$("#serveradmin").val(),h=btoa($("#server-pass").val()),m=!0===$("#import-icons").prop("checked"),p=btoa($("#instance_icon").val()),l=$("#athp_link"),k=$("#tls");l=l.length?btoa(l.val()):btoa("");var q=k.length?k.prop("checked")?1:0:0,f=$("#server-block");f.parent().scrollTop(0);if(b&&0!==b.length)if("serveradmin"!==b||confirm(tjs.get("You are about to add the instance as serveradmin (root), but it is recommended to use a custom query client for it! Do you want to continue at your own risk?")))if(h&&
0!==h.length){var g=$(".block-footer.align-right").find("button[type=button]:first");g.disableBt();(k=$(this).attr("action"))&&""!==k||(k=document.location.href.match(/^([^#]+)/)[1]);a={a:$("#a").val(),basis:a,server_ip:c,query_port:d,label:e,serveradmin:btoa(b),password:h,athp_link:l,tls:btoa(q),custom_icon:p};c=$("#redirect");0<c.length&&(a.redirect=c.val());var n=(new Date).getTime();$.ajax({url:k,dataType:"json",type:"POST",data:a,success:function(a,c,d){if(a.valid){var b=a.redirect,e={id:a.id};
a=(new Date).getTime();500>a-n?setTimeout(function(){f.importPerms(e,function(){m?f.instanceImportIcons(e,function(){document.location.href=b;g.enableBt()}):(document.location.href=b,g.enableBt())})},500-(a-n)):f.importPerms(e,function(){m?f.instanceImportIcons(e,function(){document.location.href=b;g.enableBt()}):(document.location.href=b,g.enableBt())})}else a.error?(f.removeBlockMessages().blockMessage(a.error||tjs.get("An unexpected error occurred, please try again"),{type:"error"}),g.enableBt()):
a.warning&&(f.removeBlockMessages().blockMessage(a.warning||tjs.get("An unexpected error occurred, please try again"),{type:"warning"}),g.enableBt())},error:function(a,b,c){f.removeBlockMessages().blockMessage(tjs.get("Error while contacting server, please try again"),{type:"error"});g.enableBt()}});f.removeBlockMessages().blockMessage(tjs.get("Please wait, checking..."),{type:"loading"})}else f.removeBlockMessages().blockMessage(tjs.get("Please enter password for query access"),{type:"warning"});
else f.removeBlockMessages().blockMessage(tjs.get("Process canceled"),{type:"warning"});else f.removeBlockMessages().blockMessage(tjs.get("Please enter username for query access"),{type:"warning"})})});
