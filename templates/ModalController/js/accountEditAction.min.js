var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,c,b){a instanceof String&&(a=String(a));for(var e=a.length,d=0;d<e;d++){var g=a[d];if(c.call(b,g,d,a))return{i:d,v:g}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,c,b,e){if(c){b=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var d=a[e];d in b||(b[d]={});b=b[d]}a=a[a.length-1];e=b[a];c=c(e);c!=e&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");
$(document).ready(function(){$("#multi-factor-authentication").click(function(a){a.preventDefault();$.modal({title:tjs.get("Multi-factor authentication"),draggable:!0,closeButton:!0,url:"index.php?controller=modal&action=accountEditMFA",width:480,height:540,buttons:{Save:function(a){var b=!1,c=$("#account-mfa-block");c.parent().scrollTop(0);var d=!!$("#mfa_type_email").prop("checked"),g=!!$("#mfa_type_google").prop("checked"),h="none",l="",k="";d?(h="email",k=$("#mfa_code_email").val(),6!==k.length?
c.removeBlockMessages({except:"no-hide"}).blockMessage(tjs.get("The code you entered is incorrect"),{type:"error"}):b=!0):g?(h="google",l=$("#mfa_secret").val(),k=$("#mfa_code_google").val(),6!==k.length?c.removeBlockMessages({except:"no-hide"}).blockMessage(tjs.get("The code you entered is incorrect"),{type:"error"}):b=!0):b=!0;if(!0===b){var f=$(".block-footer.align-right").find("button[type=button]:first");f.disableBt();(b=$("#account-mfa-form").attr("action"))&&""!==b||(b=document.location.href.match(/^([^#]+)/)[1]);
h={a:$("#a").val(),mfa_active:"none"!==h,mfa_type:h,mfa_secret:l,mfa_code:k};var m=(new Date).getTime();$.ajax({url:b,dataType:"json",type:"POST",data:h,success:function(b){b.valid?(b=(new Date).getTime(),500>b-m?setTimeout(function(){c.removeBlockMessages({except:"no-hide"}).blockMessage(tjs.get("Changes saved successfully"),{type:"success"});f.enableBt()},500-(b-m)):(c.removeBlockMessages({except:"no-hide"}).blockMessage(tjs.get("Changes saved successfully"),{type:"success"}),f.enableBt()),setTimeout(function(){a.closeModal()},
750)):b.error?(c.removeBlockMessages({except:"no-hide"}).blockMessage(b.error||tjs.get("An unexpected error occurred, please try again"),{type:"error",position:"top"}),f.enableBt()):b.warning&&(c.removeBlockMessages({except:"no-hide"}).blockMessage(b.warning||tjs.get("An unexpected error occurred, please try again"),{type:"warning",position:"top"}),f.enableBt())},error:function(){c.removeBlockMessages({except:"no-hide"}).blockMessage(tjs.get("Error while contacting server, please try again"),{type:"error"});
f.enableBt()}});c.removeBlockMessages({except:"no-hide"}).blockMessage(tjs.get("Please wait, processing..."),{type:"loading"})}},Close:function(a){a.closeModal()}}})});$("#password").val("");$("#password-verify").val("");$("#account-form").submit(function(a){a.preventDefault();var c=$("#account-block");c.parent().scrollTop(0);var b=$("#first_name").val(),e=$("#last_name").val(),d=$("#email").val();a=$("#password").val();var g=$("#password-verify").val(),h=$("#query_nickname").val(),l=$("#icon_pkg").val();
if(b&&0!==b.length)if(e&&0!==e.length)if(d&&0!==d.length)if(/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,99})+$/.test(d)){var k=!0;a&&0<a.length&&g!==a&&(c.removeBlockMessages().blockMessage(tjs.get("Passwords not match"),{type:"warning"}),k=!1);if(k){var f=$(".block-footer.align-right").find("button[type=button]:first");f.disableBt();(g=$(this).attr("action"))&&""!==g||(g=document.location.href.match(/^([^#]+)/)[1]);b={a:$("#a").val(),first_name:b,last_name:e,email:btoa(d)};a&&(b.password=btoa(a));0<h.length&&
(b.query_nickname=h);l&&(b.icon_pkg=l);a=$("#redirect");0<a.length&&(b.redirect=a.val());var m=(new Date).getTime();$.ajax({url:g,dataType:"json",type:"POST",data:b,success:function(a){if(a.valid){var b=(new Date).getTime();500>b-m?setTimeout(function(){c.removeBlockMessages().blockMessage(tjs.get("Changes saved successfully"),{type:"success"});f.enableBt()},500-(b-m)):(c.removeBlockMessages().blockMessage(tjs.get("Changes saved successfully"),{type:"success"}),f.enableBt());a.redirect&&(document.location.href=
a.redirect)}else a.error?(c.removeBlockMessages().blockMessage(a.error||tjs.get("An unexpected error occurred, please try again"),{type:"error",position:"top"}),f.enableBt()):a.warning&&(c.removeBlockMessages().blockMessage(a.warning||tjs.get("An unexpected error occurred, please try again"),{type:"warning",position:"top"}),f.enableBt())},error:function(){c.removeBlockMessages().blockMessage(tjs.get("Error while contacting server, please try again"),{type:"error"});f.enableBt()}});c.removeBlockMessages().blockMessage(tjs.get("Please wait, processing..."),
{type:"loading"})}}else c.removeBlockMessages().blockMessage(tjs.get("E-Mail is invalid"),{type:"warning"});else c.removeBlockMessages().blockMessage(tjs.get("E-Mail is missing"),{type:"warning"});else c.removeBlockMessages().blockMessage(tjs.get("Last name is missing"),{type:"warning"});else c.removeBlockMessages().blockMessage(tjs.get("First name is missing"),{type:"warning"})})});
