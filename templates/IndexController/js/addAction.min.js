var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,d,b){a instanceof String&&(a=String(a));for(var c=a.length,e=0;e<c;e++){var m=a[e];if(d.call(b,m,e,a))return{i:e,v:m}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,d,b){a!=Array.prototype&&a!=Object.prototype&&(a[d]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,d,b,c){if(d){b=$jscomp.global;a=a.split(".");for(c=0;c<a.length-1;c++){var e=a[c];e in b||(b[e]={});b=b[e]}a=a[a.length-1];c=b[a];d=d(c);d!=c&&null!=d&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:d})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");
$(document).ready(function(){var a=$("#instance_icon").msDropDown().data("dd");$("#instance_icon").change(function(){var a=$(this).find("option:selected").attr("data-prev");$("#instance_icon_preview").attr("src",a)});var d=$("ul.favorites"),b=d.find(".favorites-prev:first"),c=d.find(".favorites-next:first");0<d.find("li:hidden").length&&(c.show(),c.css("opacity",.7),b.show());c.click(function(a){a.preventDefault();a=$(this);var e=d.find("li:visible:first"),c=d.find("li:visible:last").next("li");c.is(":hidden")?
(e.hide(),c.show(),b.css("opacity",.7),c.next("li").is(":hidden")||a.css("opacity",0)):(a.css("opacity",0),b.css("opacity",.7))});b.click(function(a){a.preventDefault();a=$(this);var b=d.find("li:visible:first").prev("li"),e=d.find("li:visible:last");b.is(":hidden")?(b.show(),e.hide(),c.css("opacity",.7),b.prev("li").is(":hidden")||a.css("opacity",0)):(c.css("opacity",.7),a.css("opacity",0))});$("input[name=basis]").click(function(){"ts3"===$(this).val()?($("#tls").parent().parent().hide(),$("#athp_link").parent().parent().show(),
$("#query-port").attr("placeholder","10011")):($("#athp_link").parent().parent().hide(),$("#tls").parent().parent().show(),$("#query-port").attr("placeholder","10101"))});$("#server-form").submit(function(b){b.preventDefault();b=btoa($("input[name=basis]:checked").val());var c=btoa($("#server-ip").val()),d=btoa($("#query-port").val()),e=$("#serveradmin").val(),l=btoa($("#server-pass").val()),n=!0===$("#import-icons").prop("checked"),q=btoa($("#instance_icon").val()),k=$("#athp_link"),h=$("#tls");
k=k.length?btoa(k.val()):btoa("");var r=h.length?h.prop("checked")?1:0:0,f=$("#server-block");if(e&&0!==e.length)if("serveradmin"!==e||confirm(tjs.get("You are about to add the instance as serveradmin (root), but it is recommended to use a custom query client for it! Do you want to continue at your own risk?")))if(l&&0!==l.length){var g=$(this).find("button[type=submit]");g.disableBt();(h=$(this).attr("action"))&&""!==h||(h=document.location.href.match(/^([^#]+)/)[1]);b={a:$("#a").val(),basis:b,server_ip:c,
query_port:d,serveradmin:btoa(e),password:l,athp_link:k,tls:btoa(r),custom_icon:q};c=$("#redirect");0<c.length&&(b.redirect=c.val());var p=(new Date).getTime();$.ajax({url:h,dataType:"json",type:"POST",data:b,success:function(b){if(b.valid){var c=b.redirect,d={id:b.id};b=(new Date).getTime();500>b-p?setTimeout(function(){f.importPerms(d,function(){n?f.instanceImportIcons(d,function(){a.destroy();document.location.href=c;g.enableBt()}):(a.destroy(),document.location.href=c,g.enableBt())})},500-(b-
p)):f.importPerms(d,function(){n?f.instanceImportIcons(d,function(){a.destroy();document.location.href=c;g.enableBt()}):(a.destroy(),document.location.href=c,g.enableBt())})}else f.removeBlockMessages().blockMessage(b.error||tjs.get("An unexpected error occurred, please try again"),{type:"error"}),g.enableBt()},error:function(){f.removeBlockMessages().blockMessage(tjs.get("Error while contacting server, please try again"),{type:"error"});g.enableBt()}});f.removeBlockMessages().blockMessage(tjs.get("Please wait, checking..."),
{type:"loading"})}else f.removeBlockMessages().blockMessage(tjs.get("Please enter password for query access"),{type:"warning"});else f.removeBlockMessages().blockMessage(tjs.get("Process canceled"),{type:"warning"});else f.removeBlockMessages().blockMessage(tjs.get("Please enter username for query access"),{type:"warning"})})});
