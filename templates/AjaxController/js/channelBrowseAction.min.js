var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,c,d){a instanceof String&&(a=String(a));for(var e=a.length,b=0;b<e;b++){var f=a[b];if(c.call(d,f,b,a))return{i:b,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,d){a!=Array.prototype&&a!=Object.prototype&&(a[c]=d.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,c,d,e){if(c){d=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var b=a[e];b in d||(d[b]={});d=d[b]}a=a[a.length-1];e=d[a];c=c(e);c!=e&&null!=c&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:c})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,d){return $jscomp.findInternal(this,a,d).v}},"es6","es3");
$(document).ready(function(){var a=source.cid_channelBrowse,c=source.fcount_channelBrowse,d=source.tsi_virtualserver_files_download,e=source.tsi_virtualserver_files_delete,b=$("a.ts-file");b.bind("contextMenu",function(a,g){a=$(this).attr("data-cid");var f=$(this).attr("id");1===d&&(g.push({text:tjs.get("Download"),link:"javascript:void(0)",onclick:"fileDownload('"+id+"', '"+sid+"', '"+a+"', '"+f+"');",icon:"down"}),g.push(!1));1===e&&g.push({text:tjs.get("Delete"),link:"javascript:void(0)",onclick:"fileDelete('"+
id+"', '"+sid+"', '"+a+"', '"+f+"');",icon:"delete"})});b.draggable({helper:"clone"});$("#message-files-found").html("<li>"+c+" "+tjs.get(" files found")+"</li>");$(".png, .jpg, .jpeg, .gif, .bmp").click(function(){$.modal({title:tjs.get("Image Preview"),draggable:!0,closeButton:!0,url:"index.php?controller=modal&action=imagePrev&id="+id+"&sid="+sid+"&cid="+$(this).attr("data-cid")+"&fkey="+$(this).attr("id"),width:900,height:530})});$(".modal-upload-to-channel").click(function(){$.modal({title:"Upload Files To Channel",
draggable:!0,closeButton:!0,url:"index.php?controller=modal&action=filesUpload&id="+id+"&sid="+sid+"&cid="+a,buttons:{Upload:function(f){f.getModalContentBlock().find("form").fileUpload({id:id,sid:sid,cid:a},function(){var f=parent.$("#tsi-file-browser-block").find('a[id="'+a+'"]').children("span");f.click();f.children("b").length||f.wrapInner("<b></b>")})},Close:function(a){a.closeModal()}}})});$(".modal-upload-icons").click(function(){$.modal({title:tjs.get("Upload Icons To Server"),draggable:!0,
closeButton:!0,url:"index.php?controller=modal&action=iconsUpload&id="+id+"&sid="+sid,buttons:{Upload:function(a){a.getModalContentBlock().find("form").iconUpload({id:id,sid:sid},function(){var a=parent.$("#tsi-file-browser-block").find("a[id=0]").children("span");a.click();a.children("b").length||a.wrapInner("<b></b>")})},Close:function(a){a.closeModal()}}})});$(".modal-transfer-sys-icons").click(function(){var a;$.modal({title:tjs.get("Transfer TSI Icons"),draggable:!0,closeButton:!0,url:"index.php?controller=modal&action=iconsTransfer&id="+
id+"&sid="+sid,complete:function(){a=document.getElementById("icon-transfer-progress");$("#sys_icons_transfer").msDropDown().data("dd")},buttons:{Transfer:function(d){d.getModalContentBlock().find("form").iconTransfer({id:id,sid:sid},function(){var d=this.form,e=this.data,c=void 0===e.icons?[]:e.icons,b=0,f=c.length,g=0,h=0;if(c&&c!==[]&&c.hasOwnProperty(b)){a.parentElement.style.display="block";var k=function(){b<f?($.get("index.php?controller=ajax&action=pushIcon&id="+id+"&sid="+sid+"&from="+encodeURIComponent(c[b])+
"&base64ToPng=true",function(a,d){!1===(void 0===a.valid?!1:a.valid)?h++:g++;k()}),b++,a.firstElementChild.firstElementChild.style.width=(b/f*100).toFixed(0)+"%",a.firstElementChild.firstElementChild.innerHTML=(b/f*100).toFixed(0)+"%"):$.get("index.php?controller=ajax&action=refreshVirtualServerIconFileList&id="+id+"&sid="+sid,function(b,c){c=void 0===b.error?"":b.error;(void 0===b.valid?0:b.valid)?(a.parentElement.style.display="none",b="success",0<h&&0<g?(b="warning",c=g+" "+tjs.get("icons")+" "+
tjs.get("successfully imported")+"/ "+h+" "+tjs.get("icons")+" "+tjs.get("could not be imported")):0<h?(b="error",c=h+" "+tjs.get("icons")+" "+tjs.get("could not be imported")):c=g+" "+tjs.get("icons")+" "+tjs.get("successfully imported"),d.removeBlockMessages({except:"no-hide"}).blockMessage(c,{type:b,position:"top",noMargin:!0})):d.removeBlockMessages({except:"no-hide"}).blockMessage(c,{type:"error",position:"top",noMargin:!0});b=parent.$("#tsi-file-browser-block").find("a[id=0]").children("span");
b.click();b.children("b").length||b.wrapInner("<b></b>")})};k()}})},Close:function(a){a.closeModal()}}})});$(this).applyTemplateSetup()});function fileDownload(a,c,d,e){$("#tsi-file-browser-block").fileDownload({id:a,sid:c,cid:d,fkey:e},function(){download($(this))})}
function fileDelete(a,c,d,e){var b=$("#tsi-files");$("#tsi-file-browser-block").fileDelete({id:a,sid:c,cid:d,fkey:e},function(){var a=b.find('a[id="'+e+'"]').parent("li");a.fadeOut("slow");var c=--b.find("li:visible").length;$("#message-files-found").children("li").html(c+" "+tjs.get(" files found"));2>c&&a.children("b").contents().unwrap();b.find("a.ts-file").each(function(){var a=parseInt($(this).attr("id"));a>e&&$(this).attr("id",a-1)})})};
